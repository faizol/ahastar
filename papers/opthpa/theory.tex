\section{Pruning Symmetric Paths Offline}
\label{algorithm}
Pathfinding in modern video games often involves exploring highly regular 
environments such as cities, sewers or dungeons (e.g Figure \ref{fig-bgmap}).
Though these locales tend to be topographically simple (usually being comprised
of empty rooms connected by corridors) they can also be highly symmetric 
with many optimal length paths existing between arbitrary pairs of locations.
Symmetry is undesirable as it increases the size of the search space
and forces search algorithms to waste time that could be spent finding better solutions.
\par
We propose the following offline strategy for identifying and eliminating symmetric paths in 
4-connected grid maps:
\begin{enumerate}
\item{Decompose the grid map into a set of empty rooms, where each empty room is 
rectangular in shape and free of any obstacles.}
\item{Prune all nodes from the interior of each empty room.}
\item{Add a series of \emph{macro edges} that connect each node on the perimeter of an empty room
with a node on the directly opposite side of the room.}
\end{enumerate}
Figure \ref{fig-overview} shows an example of this process.
It is easy see to see that we eliminate a large number of symmetric paths
that exist between arbitrary pairs of nodes on the perimeter of each room.
In many cases there remains only one optimal length path between each 
pair of nodes in each room.
We claim that this approach preserves optimality when searching in 
4-connected grid maps. 

\begin{lemma}
\label{thm-roomtraversal}
Let $R$ be an arbitrary 4-connected rectangular room that is free of obstacles.
and $s, g \in R$ be the endpoints of an optimal length path 
segment $\pi^*(s, g)$ running through the interior of $R$. 
For each such path there exists another optimal length path $\pi'(s, g)$ 
which involves only nodes from the perimeter of $R$. 
%For every optimal length path segment running through the interior of an empty 
%4-connected rectangular room $R$ there exists another equivalent length path 
%segment which involves only nodes from the perimeter of $R$.
\end{lemma}
\begin{proof}
\par
As $\pi^*(s, g)$ is a segment of an optimal path both $s$ and $g$ are located on the perimeter of $R$.
If $g$ is on the same side of the perimeter to $s$ or on one of the two orthogonal sides 
it follows that we can find an optimal length path between them by the successive expansion of 
nodes adjacent to $s$ along the perimeter.
Suppose however that $g$ is somewhere on the opposite side of $R$.
In this case we can simply follow the macro edge at $s$ to navigate directly to a node $s'$ located on
the same side of the perimeter as $g$.
Thus $\pi'(s, g) = \pi(s, s') + \pi(s',g)$.
As $R$ is 4-connected it is trivial to show that the length of $\pi'(s, g)$ is equal to $\pi^*(s, g)$.
\end{proof}

A direct corrolary to Lemma \ref{thm-roomtraversal} is that we can prune from consideration
all nodes from the interior of $R$ and limit ourselves to those nodes appearing along its perimeter.
